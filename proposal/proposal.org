#+TITLE: Learning Portfolio Optimization of Electric Vehicle Virtual Power Plants in Smart Sustainable Electricity Markets: A ML-based Intelligent Agent Approach
#+SUBTITLE: Master Thesis Proposal
#+AUTHOR:Tobias Richter

# Formatting
#+LATEX_HEADER: \usepackage[margin=1.5in]{geometry}
#+LATEX_HEADER: \usepackage{setspace}
#+LATEX_HEADER: \onehalfspacing
#+OPTIONS: H:4

# Bibliography
#+LATEX_HEADER: \usepackage[backend=biber, style=apa]{biblatex}
#+LATEX_HEADER: \addbibresource{~/uni/ma-thesis/bibliography/references.bib}

# TOC
#+LATEX_HEADER: \usepackage[notbib,notlof,notlot,nottoc]{tocbibind}

* Introduction (1-2 Pages)
** Research Motivation
The global climate change is one biggest challenges of our time. Carbon
emissions need to be reduced and the shift to sustainable energy sources is
inevitable. But integration of renewables into the electricity
grid proves to be difficult: Solar and wind energy is intermittent and hard
to integrate into the power grid. Sustainable electricity production is dependent
on the weather, under- and oversupplies occur and destabilize the grid.
# TODO: Make introduction coherent
# Electric vehicles (EV) powered by sustainable energy sources are
# Connection, Also Smart Sustainable Markets?
# The future of mobility is autonomous, connected, electric and shared.

Virtual power plants (VPP) play an important role in stabilizing the grid.
VPPs aggregate distributed power sources to consume and produce electricity when
it is needed. Carsharing companies operate large, centrally-managed fleets of
electric vehicles (EV) in major cities around the world. These EV fleets can be
turned into VPPs, using their batteries as combined electricity storage.
In this way EV fleets can offer balancing services to the power grid or trade
electricity on the open markets for arbitrage purposes.
# Rewrite
Carsharing companies can charge the fleet (buy electricity), when there is an excess of
electricity and discharge EVs (sell electricity), when there is a shortage of electricity.
By making their EVs available to be used as a VPP, carsharing companies
compromise customer mobility and the profitability of their fleet. Renting out
an EV to a customer is considerably more lucrative than using it for trading electricity.

Knowing how many EVs will most likely be rented out in a future point of time
and consequently obtaining an accurate forecast of available battery capacity is essential
for a successful trading strategy. Moreover it is possible for fleet owners to trade on
multiple electricity markets simultaneously. Electricity markets differ in
price elasticity, as well as reaction time between contractual agreement and
physical delivery.

# TODO: Citation needed
Participating in operating reserve markets and spot markets at the same time
can mitigates risks and increase profits. Allocating EVs to different types of VPPs, that
participate on the respective markets is an optimization problem, which aim to solve.

In this research we propose an portfolio optimizing strategy, in which the best
composition of the VPP portfolio, consisting of operating reserve
VPPs and spot market VPPs, will be dynamically determined. To address changing
electricity price levels and customer demands over time we additionally propose an
the use of intelligent agent trading strategy, in which an agent learns from historical data
and adjust to its current environment.

The following tasks will be performed by the agent in real time: 1) /Allocation of plugged in
EVs to idle or VPP state/, 2) /Learn the optimum of VPP portfolio
composition/ and 3) /Place bids and asks on corresponding electricity markets with an
integrated trading strategy/.

** Research Question
Drawing upon the research motivation, the following research questions are derived.
They build upon another and will be sequentially addressed during this research:

1. /What are spatio-temporal customer demand patterns of carsharing EVs?/

  Knowing customer demand patterns results in an accurate forecast of how much
  available battery capacity an EV fleet will have at any point in time.

2. /What is the optimal allocation ratio of the available capacity between operating
  reserve market VPPs and spot market VPPs?/

  Dynamically learning the optimal share of capacity to trade on the
  respective markets will maximize profits, while reducing the risk of foregone
  customer profits.

  # TODO: Introduce specific markets
3. /How does an integrated bidding strategy look like, which considers trading electricity
    the secondary operating reserve market and the continuous intraday market simultaneously?/

   Designing a strategy and determine optimal auction prices, which takes the specific market
   designs of the German secondary operating reserve market and continuous intraday market into account.


** Relevance of the Research
*** Relevance to Practice

From a business perspective this research is mainly relevant to carsharing
companies, such as Car2Go or DriveNow, which are operating an EV fleet. We will show how
these companies can increase their profits, using idle EVs as VPPs to trade
electricity on multiple markets simultaneously.

# TODO: Consider notion of different (mutually exclusive states)
# TODO: DSS not introduced yet
We propose the use of a decision support system (DSS), which allocates idle EVs to either type of VPP or to be available for renting. Furthermore the DSS will determine optimal ask, bids and capacities to trade on the individual electricity markets.

# TODO: Different Section?
In addition, we will estimate the profitability increase, when implementing the proposed methods.
This will be done using real-world data from German electricity markets and trip data from a German carsharing provider.

*** Relevance to Science

From a scientific perspective this research is relevant to the stream of agent-based decision making in smart markets parencite:bichler10_resear_commen_desig_smart_market,peters2013reinforcement. We will contribute to the body of Design Science in Information Systems parencite:hevner04_desig_scien_infor_system_resear and draw upon work done in multitude of research areas: Virtual Power Plants in smart electricity markets, carsharing as a new way of sustainable mobility and advanced machine learning methods for forecasting and prediction.

Similar research has been carried out by textcite:kahlen18_elect_vehic_virtual_power_plant_dilem and textcite:kahlen17_fleet. In their research the authors concentrate on participating in one type of electricity market at a time. As proposed by citeauthor:kahlen18_elect_vehic_virtual_power_plant_dilem we will take this research further and use the EV VPPs to act on multiple types of electricity markets simultaneously. Moreover we aim to use sophisticated machine learning methods (i.e. recurrent neural networks, ensemble learning) to carry out more accurate forecasts of rental demand and dynamically learn allocation ratios to the individual markets.

textcite:he16_optim_biddin_strat_batter_storag and textcite:mashhour11_biddin_strat_virtual_power_plant_2,mashhour11_biddin_strat_virtual_power_plant_1 researched on optimal bidding strategies for using VPPs to jointly bid on multiple markets. The authors use stationary storage to participate in day-ahead and spinning-reserve markets. Contrarily, we aim to use non-stationary storage (i.e. EV batteries) to participate in the continuous intraday market and the secondary reserve market (known as real-time market in the US).

*** Relevance to Society

This research contributes to the overall welfare of the society in three points. First, VPPs of EVs provide extra balancing services to the power grid. The VPPs can consume excess electricity (almost) instantly and stabilize the power grid like this. When integrating more intermittent renewable electricity sources into the grid in the future, such balancing services will become indispensable.
# As opposed to idle-power plants or gas turbines
Second, a reduction of electricity prices for the end-consumer is expected. Integrating VPPs into the power grid increases the efficiency of the whole system and hence is  lowering prices. textcite:kahlen18_elect_vehic_virtual_power_plant_dilem show results, where electricity prices decrease up to 3.4% on the wholesale market. We anticipate similar results in our research.

# TODO: Explain what curtailment means. Explain merit order, low marginal costs
Third, VPPs can lead to a decrease in CO_2 emissions. With an increasing share of renewable energy production, the supply of sustainable electricity can excess total electricity demand at times of good weather conditions. The VPPs can consume this electricity by charging the EV fleet and the sustainable energy production does not need to be curtailed. The EV fleet can then feed the electricity back into the grid, when there is more demand than sustainable electricity production. With this mechanism the total CO_2 emissions can be reduced.

* Empirical Setting (1 Pages)
- Describe relevance and mechanisms of car-sharing and electricity market auctions
- Show excerpts of the available data and explain.
- Use same time span for car data as respective market data (!?)
- Timespan: 01.12.2016 - 31.01.2018

** Carsharing Fleets
- EV car fleets
- Environmental Impact: Future of mobility is electric, smart, and eventually autonomous

- Carsharing business model: Flee float
- Car2Go: Stuttgart
- Exemplary Car2Go data is shown in Table ref:car2go-sample-data

#+CAPTION: Car2Go Raw Trip Data from Stuttgart label:car2go-sample-data
#+ATTR_LATEX: :environment longtable :align l|p{1.5cm}p{1.5cm}p{3.5cm}p{1.5cm}p{2.8cm}
|--------------+----------+-----------+---------------------+----------+-----------------|
|--------------+----------+-----------+---------------------+----------+-----------------|
| Number Plate | Latitude | Longitude | Street              | Zip Code | Engine Type     |
|--------------+----------+-----------+---------------------+----------+-----------------|
| S-GO2471     | 9.19121  | 48.68895  | Parkplatz Flughafen | 70692    | electric        |
| S-GO2471     | 9.15922  | 48.78848  | Salzmannweg 3       | 70192    | electric        |
| S-GO2471     | 9.17496  | 48.74928  | Felix-Dahn-Str.45   | 70597    | electric        |
| S-GO2471     | 9.17496  | 48.74928  | Felix-Dahn-Str.45   | 70597    | electric        |
| S-GO2471     | 9.17496  | 48.74928  | Felix-Dahn-Str.45   | 70597    | electric        |
|--------------+----------+-----------+---------------------+----------+-----------------|
| Number Plate | Interior | Exterior  | Timestamp           | Charging | State of Charge |
|--------------+----------+-----------+---------------------+----------+-----------------|
| S-GO2471     | good     | good      | 22.12.2017 20:10    | no       | 94              |
| S-GO2471     | good     | good      | 24.12.2017 23:05    | no       | 72              |
| S-GO2471     | good     | good      | 26.12.2017 00:40    | yes      | 81              |
| S-GO2471     | good     | good      | 26.12.2017 00:45    | yes      | 83              |
| S-GO2471     | good     | good      | 26.12.2017 00:50    | yes      | 84              |
|--------------+----------+-----------+---------------------+----------+-----------------|
|--------------+----------+-----------+---------------------+----------+-----------------|


 (Fri, Sun, Tue, Tue, Tue)
** Electricity Markets
# Electricity markets are auctions where participants can buy and sell electricity
# to match demand for electricity and supply of electricity generation. To match
# participants asks (sell orders) and bids (buy orders) optimally we rely on smart
# electronic market structures. Smart markets are auction mechanisms that rely on
# optimization techniques to match demand and supply (McCabe et al., 1991; Gallien
# and Wein, 2005; Bichler et al., 2010; Ketter, 2014)


# In liberalized energy systems, where the production and distribution of electricity is
# separated, there are several energy markets. Fleets of EVs could sell their storage on
# all of these energy markets to benefit from price differences over time. However, not all
# of them are equally well suited for this purpose. In principle the markets are different
# from each other in terms of their reaction time between the contractual agreement
# and physical delivery of electricity. This ranges from more than 24 hours, or usually
# several months or years in advance in derivative markets, over day-ahead and spot
# markets where the reaction time is usually several hours, to operating reserve markets,
# where the reaction time is restricted to several minutes or seconds only. Figure 1.2
# shows the energy markets that typically exist in liberalized energy systems and their
# reaction times.

*** Operating reserve market
offer higher profits, due to a very low reaction time
 between contractual agreement and physical delivery. They also bear a higher risk for the
 fleet. Commitments have to be made one week in advance, where customer demands
 are uncertain. To not face penalties for unfulfilled commitments, only a
 conservative estimation of available battery capacity can be made. This leaves
 a lot of potential EV capacity unused.


#+CAPTION: Anonymized List of Bids of the German Secondary Reserve Market at the 04.12.2017
#+ATTR_LATEX: :float sideways :align l|ccccc :placement [hp]
|---------------------+-------------------------+-----------------------+---------------+--------------+---------------|
|---------------------+-------------------------+-----------------------+---------------+--------------+---------------|
| Product[fn:product] | Capacity Price [EUR/MW] | Energy Price [EUR/MW] | Payment       | Offered [MW] | Accepted [MW] |
|---------------------+-------------------------+-----------------------+---------------+--------------+---------------|
| NEG-HT              |                       0 |                   1.1 | TSO to bidder |            5 |             5 |
| NEG-HT              |                       0 |                   251 | TSO to bidder |           15 |            15 |
| NEG-HT              |                       0 |                   564 | TSO to bidder |           22 |            22 |
| ...                 |                     ... |                   ... | ...           |          ... |           ... |
| NEG-NT              |                       0 |                  21.9 | Bidder to TSO |            5 |             5 |
| NEG-NT              |                       0 |                  22.4 | Bidder to TSO |            5 |             5 |
| ...                 |                     ... |                   ... | ...           |          ... |           ... |
| POS-NT              |                   696.6 |                  1200 | TSO to bidder |            5 |             5 |
| POS-NT              |                  717.12 |                  1210 | TSO to bidder |           10 |             7 |
|---------------------+-------------------------+-----------------------+---------------+--------------+---------------|
|---------------------+-------------------------+-----------------------+---------------+--------------+---------------|

[fn:product] NEG-NT = Product code for negative secondary control reserve to be
provided between the hours of 00:00h and 08:00h as well as between 20:00h and
24:00h from Monday through Friday as well as all day on Saturday, Sunday and public holidays
applicable to all of Germany

POS-HT = Product code for positive secondary
control reserve to be provided between the hours of 08:00h and 20:00h from
Monday through Friday.

*** Continuous intraday market
 allow participants to continuously trade electricity products up
 to 15 minutes prior to delivery (in Germany). At this point it is possible to
 predict customer demand with a high accuracy, which generates the possibility
 to trade the remaining available capacity with a low risk.





- Balancing vs. Spot Markets
- Market designs
*** Epex Spot Market: Continuous intraday trading
- Market design
- Exemplary data
- Epex Spot Market: Continuous intraday trading data from 2016-2017.
*** German secondary operating reserve market
- Market design
- Exemplary data ref:spot-market-sample-data


#+CAPTION: Exemplary Spot Market Auction Data label:spot-market-sample-data
| Bid Id | Price |
|--------+-------|
|      1 |     7 |
|      2 |     9 |
|      3 |     3 |
- Secondary operating reserve market data from Germany (https://regelleistung.net)
* Literature Review (1-2 Pages)
# TODO: Scrap
# Agent Theory: Dynamically optimize the allocation of EVs to different types of VPP using recurrent neural networks.
# Agent Theory/ML: Application and comparison of Advanced ML Models (for spatial time-series forecasting)
# Auction Theory: Integrated trading strategy to participate in multiple markets

** Electric Vehicles, Virtual Power Plants, V2G
textcite:peterson10_econom_using_plug_in_hybrid

cite:mashhour11_biddin_strat_virtual_power_plant_1

cite:mashhour11_biddin_strat_virtual_power_plant_2

cite:mak13_infras_plann_elect_vehic_with_batter_swapp

cite:kim12_carbit

cite:kara15_estim_benef_elect_vehic_smart

cite:he16_optim_biddin_strat_batter_storag

cite:fridgen2014value

cite:kahlen18_elect_vehic_virtual_power_plant_dilem

- Kahlen present very conversative results and propose the combination of multiple markets in future work. In their approach the VPPs are mainly used to buy from the markets when electricity is cheap and thus charge their EVs basically for free (Citatation). V2G is almost never used.

cite:kahlen17_fleet

cite:kahlen15_aggreg_elect_cars_sustain_virtual_power_plant

** DSS, Intelligent Agents, State of the Art ML Techniques
cite:avci18_manag_elect_price_model_risk
** Carsharing (?)
cite:firnkorn15_free_float_elect_carsh_fleet_smart_cities
** More Papers
*** Main Papers

cite:sioshansi12_or_forum_model_impac_elect

cite:valogianni2014effective

cite:vytelingum2011theoretical

cite:wagner16_in_free_float

cite:wolfson11_better_place

cite:zhou16_elect_tradin_negat_prices
*** Touching Papers and Conference Papers
cite:ketter13_power_tac

cite:ketter16_multiagent_comp_gaming

cite:ketter16_comp_bench

cite:ketter16_comp_bench

* Research Design (1-2 Pages)
The research will be structured using the IS design science principles proposed by Hevner et
al. (2004). In Figure ref:research-design the proposed research design is depicted.
We will place a special focus on the used methodologies, the developed artifact
and the evaluation of the results.
Drawing from the /Knowledge Base/, multiple methods will be compared and evaluated against each
other and thus emphasising /Research Rigor/. Considering /Business Needs/, we
will develop an /Artifact/ in form of a decision support system. Evaluating
the results with real-world data with a simulation will make sure the /Artifact/
is /applicable in the appropriate environment/ (i.e. carsharing fleets).

#+CAPTION: Research Design following Hevner et al., 2004  label:research-design
[[./figures/Hevner_Proposal.png]]
** Problem relevance: Environmental (People), carsharing (Business)
** Methodologies
Draw upon well researched statistical and machine learning methods: statistical pattern recognition, time-series forecasting and artificial neural networks.
*** Quantitative Study
- What is the purpose of the study?
 1. EV Capacity Prediction / Demand Prediction
 2. Dynamic VPP Allocation Learning
 3. Determine Bids/Asks/Market: Price Prediction
*** ML-based Intelligent Agents
** Artifact: Instantiation of an intelligent agent.
- Thus: An intelligent Agent is needed, which dynamically allocates parked, plugged-in EVs to be
 used as VPP or stay idle, depending whether an EV is likely going to be rented out and how much
 capacity it has available.
** Evaluation: Event-based simulation using real-world data
-Using real-world data from German electricity markets and trip data from a carsharing provider.
* Research Plan (0.5 Page)



* Wolf Requirements
** MA Proposal

- The proposal depicts the main background and motivation of your research topic.
- Based on the proposal, a concise research question is to be derived and formulated.
- The methodological approach shall be outlined.
- The suggested methods and algorithms shall be listed.
- Please give an overview on the respective data.
- The proposal already has to include relevant literature references.
- Please note that special focus shall be placed on the research question and the respective approach.
** PhD Proposal
 Specially attention is paid to related work, data, methods, and analysis, and potential contribution/conclusion.

\printbibliography
